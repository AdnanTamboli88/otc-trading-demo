<!DOCTYPE html>
<html>
<head>
<title>EUR/GBP OTC</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;
    background:#0f172a;
    color:white;
    font-family:Arial;
}

.topbar{
    display:flex;
    justify-content:space-between;
    padding:15px 30px;
}

.rightpanel{
    position:absolute;
    top:80px;
    right:20px;
    width:220px;
    background:#111827;
    padding:20px;
    border-radius:10px;
}

.rightpanel input{
    width:100%;
    padding:8px;
    margin-bottom:10px;
    text-align:center;
}

.rightpanel button{
    width:100%;
    padding:12px;
    margin-top:8px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-size:16px;
}

.up{background:#16a34a;color:white;}
.down{background:#dc2626;color:white;}

canvas{
    margin-left:20px;
    margin-top:20px;
    background:#111827;
}

.history{
    position:absolute;
    bottom:20px;
    right:20px;
    width:220px;
    background:#111827;
    padding:15px;
    border-radius:10px;
    font-size:14px;
    max-height:200px;
    overflow:auto;
}

#message{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:28px;
    display:none;
}
</style>
</head>
<body>

<div class="topbar">
<div>Balance: $<span id="balance"></span></div>
<div>Timer: <span id="timer">--</span></div>
</div>

<canvas id="chart" width="900" height="500"></canvas>

<div class="rightpanel">
Trade Amount $
<input type="number" id="amount" value="10">
<button class="up" onclick="placeTrade('up')">UP</button>
<button class="down" onclick="placeTrade('down')">DOWN</button>
</div>

<div class="history">
<b>Trade History</b>
<div id="historyList"></div>
</div>

<div id="message"></div>

<script>
let balance = localStorage.getItem("balance") ? parseFloat(localStorage.getItem("balance")) : 1000;
document.getElementById("balance").innerText = balance;

let currentPrice = 1.1000;
let data = [];
let labels = [];
let entryLine = null;
let tradeActive=false;
let entryPrice=0;
let direction="";
let expiry=60;
let timerInterval;

const ctx=document.getElementById("chart").getContext("2d");

function generateCandle(){
    let open=currentPrice;
    let close=open+(Math.random()-0.5)*0.004;
    currentPrice=close;
    return close;
}

for(let i=0;i<40;i++){
    data.push(generateCandle());
    labels.push(i);
}

const chart=new Chart(ctx,{
type:'line',
data:{
labels:labels,
datasets:[
{
label:'EUR/GBP',
data:data,
borderColor:'#22c55e',
borderWidth:2,
tension:0
},
{
label:'Entry',
data:[],
borderColor:'yellow',
borderWidth:2,
pointRadius:0
}
]
},
options:{
responsive:false,
scales:{
x:{ticks:{color:'white'}},
y:{ticks:{color:'white'}}
}
}
});

setInterval(()=>{
data.push(generateCandle());
data.shift();
chart.update();
},2000);

function placeTrade(dir){
if(tradeActive) return;

let amount=parseFloat(document.getElementById("amount").value);
if(amount<=0||amount>balance) return;

tradeActive=true;
direction=dir;
entryPrice=currentPrice;
balance-=amount;
updateBalance();

drawEntryLine(entryPrice);

let timeLeft=expiry;
document.getElementById("timer").innerText=timeLeft;

timerInterval=setInterval(()=>{
timeLeft--;
document.getElementById("timer").innerText=timeLeft;
if(timeLeft<=0){
clearInterval(timerInterval);
finishTrade(amount);
}
},1000);
}

function drawEntryLine(price){
chart.data.datasets[1].data=new Array(data.length).fill(price);
chart.update();
}

function finishTrade(amount){
let win=false;
if(direction==="up"&&currentPrice>entryPrice) win=true;
if(direction==="down"&&currentPrice<entryPrice) win=true;

let msg=document.getElementById("message");

if(win){
balance+=amount*1.8;
msg.style.color="#22c55e";
msg.innerText="WIN";
}else{
msg.style.color="#ef4444";
msg.innerText="LOSS";
}

msg.style.display="block";

addHistory(win,amount);

setTimeout(()=>{
msg.style.display="none";
chart.data.datasets[1].data=[];
chart.update();
},3000);

document.getElementById("timer").innerText="--";
updateBalance();
tradeActive=false;
}

function addHistory(win,amount){
let h=document.getElementById("historyList");
let div=document.createElement("div");
div.innerText=(win?"Win ":"Loss ")+"$"+amount;
div.style.color=win?"#22c55e":"#ef4444";
h.prepend(div);
}

function updateBalance(){
document.getElementById("balance").innerText=balance;
localStorage.setItem("balance",balance);
}
</script>

</body>
</html>

